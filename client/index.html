<!DOCTYPE html>
<html lang="fr">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Nextcloud Media Player</title>
	<link rel="stylesheet" href="styles.css">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link
		href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400&family=IBM+Plex+Mono:wght@400;500&display=swap"
		rel="stylesheet">

	<meta name="theme-color" content="#050507">
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="apple-mobile-web-app-title" content="Pastamedia">
	<meta name="application-name" content="Pastamedia">
	<meta name="msapplication-TileColor" content="#050507">
	<meta name="msapplication-TileImage" content="/favicon.ico">
	<meta name="description" content="Lecteur multimédia connecté à votre Nextcloud">
	
	<link rel="manifest" href="/manifest.json">
	
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
	<link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico">
	<link rel="apple-touch-icon" sizes="152x152" href="/favicon.ico">
	<link rel="apple-touch-icon" sizes="144x144" href="/favicon.ico">
	<link rel="apple-touch-icon" sizes="120x120" href="/favicon.ico">
	
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>

<body>
	<div class="app">

		<!-- LOGIN -->
		<div id="login-screen" class="screen active">
			<div class="login-card">
				<div class="login-icon">
					<svg width="36" height="36" viewBox="0 0 24 24" fill="none" stroke="currentColor"
						stroke-width="1.2">
						<polygon points="5 3 19 12 5 21 5 3" />
					</svg>
				</div>
				<h1>NC<span class="hi">MP</span></h1>
				<p class="login-sub">Lecteur multimédia connecté à votre Nextcloud</p>
				<a id="login-btn" class="btn btn-accent">
					<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<path d="M15 3h4a2 2 0 012 2v14a2 2 0 01-2 2h-4M10 17l5-5-5-5M15 12H3" />
					</svg>
					Connexion Nextcloud
				</a>
			</div>
		</div>

		<!-- MAIN APP -->
		<div id="app-screen" class="screen">

			<!-- Top bar -->
			<header class="topbar">
				<div class="topbar-left">
					<div class="brand">
						<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
							stroke-width="1.8">
							<polygon points="5 3 19 12 5 21 5 3" />
						</svg>
						<span>NC<span class="hi">MP</span></span>
					</div>
					<nav class="main-nav" id="main-nav">
						<button class="nav-tab active" data-view="medias">Médias</button>
						<button class="nav-tab" data-view="playlists">Playlists</button>
					</nav>
				</div>
				<div class="topbar-right">
					<div class="user-pill">
						<span class="user-dot" id="user-dot">A</span>
						<span id="user-name">admin</span>
					</div>
					<button class="icon-btn" id="logout-btn" title="Déconnexion">
						<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
							stroke-width="2">
							<path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4M16 17l5-5-5-5M21 12H9" />
						</svg>
					</button>
				</div>
			</header>

			<!-- CONTENT -->
			<div class="content-scroll" id="content-scroll">

				<!-- MEDIAS VIEW -->
				<section class="view" id="view-medias">
					<div class="view-header">
						<h2 id="media-title">Bibliothèque musicale</h2>
						<div class="search-wrap">
							<svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor"
								stroke-width="2">
								<circle cx="11" cy="11" r="8" />
								<path d="M21 21l-4.35-4.35" />
							</svg>
							<input type="text" class="search-input" id="search-input" placeholder="Rechercher…"
								spellcheck="false">
							<button class="search-clear hidden" id="search-clear">
								<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
									stroke-width="2">
									<path d="M18 6L6 18M6 6l12 12" />
								</svg>
							</button>
						</div>
					</div>

					<!-- Scan status -->
					<div class="scan-status hidden" id="scan-status">
						<div class="spinner-small"></div>
						<span>Analyse de votre bibliothèque…</span>
					</div>

					<!-- Album/folder groups -->
					<div class="media-content" id="media-content"></div>

					<div class="empty-state hidden" id="media-empty">
						<svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor"
							stroke-width="0.8" opacity="0.2">
							<path d="M9 18V5l12-2v13" />
							<circle cx="6" cy="18" r="3" />
							<circle cx="18" cy="16" r="3" />
						</svg>
						<p>Aucun fichier audio trouvé</p>
					</div>
				</section>

				<!-- PLAYLISTS VIEW -->
				<section class="view hidden" id="view-playlists">
					<div class="view-header">
						<h2>Playlists</h2>
						<button class="btn btn-small btn-outline" id="btn-new-playlist">
							<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
								stroke-width="2">
								<path d="M12 5v14M5 12h14" />
							</svg>
							Nouvelle
						</button>
					</div>
					<div class="playlist-grid" id="playlist-grid"></div>

					<!-- Playlist detail -->
					<div class="playlist-detail hidden" id="playlist-detail">
						<div class="detail-header">
							<button class="icon-btn" id="btn-back-playlists">
								<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
									stroke-width="2">
									<path d="M19 12H5M12 19l-7-7 7-7" />
								</svg>
							</button>
							<input class="detail-name" id="detail-name" value="" spellcheck="false">
							<div class="detail-actions">
								<button class="icon-btn" id="btn-shuffle" title="Aléatoire">
									<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
										stroke-width="2">
										<polyline points="16 3 21 3 21 8" />
										<line x1="4" y1="20" x2="21" y2="3" />
										<polyline points="21 16 21 21 16 21" />
										<line x1="15" y1="15" x2="21" y2="21" />
										<line x1="4" y1="4" x2="9" y2="9" />
									</svg>
								</button>
								<button class="icon-btn" id="btn-play-all" title="Tout lire">
									<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
										<polygon points="5 3 19 12 5 21 5 3" />
									</svg>
								</button>
								<button class="icon-btn" id="btn-save-nc" title="Sauvegarder .m3u">
									<svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor"
										stroke-width="2">
										<path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z" />
										<polyline points="17,21 17,13 7,13 7,21" />
										<polyline points="7,3 7,8 15,8" />
									</svg>
								</button>
								<button class="icon-btn danger-icon" id="btn-delete-playlist" title="Supprimer">
									<svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor"
										stroke-width="2">
										<path
											d="M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2" />
									</svg>
								</button>
							</div>
						</div>
						<div class="detail-meta" id="detail-meta"></div>
						<div class="detail-tracks" id="detail-tracks"></div>
					</div>
				</section>
			</div>

			<!-- BOTTOM PLAYER BAR -->
			<div class="player-bar hidden" id="player-bar">
				<div class="pb-progress" id="pb-progress-bar">
					<div class="pb-progress-fill" id="pb-progress-fill"></div>
				</div>
				<div class="pb-inner">
					<div class="pb-left" id="pb-left">
						<div class="pb-cover" id="pb-cover">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor" opacity="0.4">
								<path d="M9 18V5l12-2v13" />
								<circle cx="6" cy="18" r="3" />
								<circle cx="18" cy="16" r="3" />
							</svg>
						</div>
						<div class="pb-info">
							<span class="pb-title" id="pb-title">—</span>
							<span class="pb-sub" id="pb-sub">—</span>
						</div>
					</div>
					<div class="pb-center">
						<button class="icon-btn" id="btn-prev">
							<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
								<path d="M19 20L9 12l10-8v16zM5 19V5h2v14H5z" />
							</svg>
						</button>
						<button class="icon-btn pb-play" id="btn-play">
							<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" id="play-icon">
								<polygon points="5 3 19 12 5 21 5 3" />
							</svg>
						</button>
						<button class="icon-btn" id="btn-next">
							<svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
								<path d="M5 4l10 8-10 8V4zM17 5v14h2V5h-2z" />
							</svg>
						</button>
					</div>
					<div class="pb-right">
						<button class="icon-btn" id="btn-shuffle-toggle" title="Aléatoire">
							<svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor"
								stroke-width="2">
								<polyline points="16 3 21 3 21 8" />
								<line x1="4" y1="20" x2="21" y2="3" />
								<polyline points="21 16 21 21 16 21" />
								<line x1="15" y1="15" x2="21" y2="21" />
								<line x1="4" y1="4" x2="9" y2="9" />
							</svg>
						</button>
						<div class="volume-wrap">
							<button class="icon-btn" id="btn-mute" title="Volume">
								<svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor"
									stroke-width="2" id="volume-icon">
									<polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" />
									<path d="M19.07 4.93a10 10 0 010 14.14M15.54 8.46a5 5 0 010 7.07" />
								</svg>
							</button>
							<input type="range" class="volume-slider" id="volume-slider" min="0" max="100" value="80">
						</div>
						<button class="icon-btn" id="btn-add-queue" title="Ajouter à la playlist">
							<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
								stroke-width="2">
								<path d="M12 5v14M5 12h14" />
							</svg>
						</button>
						<button class="icon-btn" id="btn-expand" title="Détails">
							<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
								stroke-width="2">
								<path d="M18 15l-6-6-6 6" />
							</svg>
						</button>
					</div>
				</div>
			</div>

			<!-- DRAWER -->
			<div class="drawer hidden" id="drawer">
				<div class="drawer-overlay" id="drawer-overlay"></div>
				<div class="drawer-content">
					<div class="drawer-head">
						<button class="icon-btn" id="btn-collapse">
							<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
								stroke-width="2">
								<path d="M6 9l6 6 6-6" />
							</svg>
						</button>
						<span class="drawer-title">En lecture</span>
					</div>
					<div class="drawer-player">
						<div class="drawer-cover" id="drawer-cover">
							<svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor" opacity="0.2">
								<path d="M9 18V5l12-2v13" />
								<circle cx="6" cy="18" r="3" />
								<circle cx="18" cy="16" r="3" />
							</svg>
						</div>
						<div class="drawer-track-name" id="drawer-track-name">—</div>
						<div class="drawer-track-path" id="drawer-track-path">—</div>
						<div class="drawer-time">
							<span id="time-current">0:00</span>
							<input type="range" class="seek-bar" id="seek-bar" min="0" max="100" value="0">
							<span id="time-total">0:00</span>
						</div>
						<div class="drawer-controls">
							<button class="icon-btn" id="d-prev">
								<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
									<path d="M19 20L9 12l10-8v16zM5 19V5h2v14H5z" />
								</svg>
							</button>
							<button class="icon-btn d-play" id="d-play">
								<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" id="d-play-icon">
									<polygon points="5 3 19 12 5 21 5 3" />
								</svg>
							</button>
							<button class="icon-btn" id="d-next">
								<svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
									<path d="M5 4l10 8-10 8V4zM17 5v14h2V5h-2z" />
								</svg>
							</button>
						</div>
						<div class="drawer-volume">
							<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor"
								stroke-width="2">
								<polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5" />
								<path d="M15.54 8.46a5 5 0 010 7.07" />
							</svg>
							<input type="range" class="volume-slider" id="drawer-volume" min="0" max="100" value="80">
						</div>
						<div class="drawer-meta" id="drawer-meta"></div>
					</div>
					<div class="drawer-queue-title">File d'attente</div>
					<div class="drawer-queue" id="drawer-queue"></div>
				</div>
			</div>
		</div>

		<audio id="audio-player" preload="auto"></audio>
		<div class="loading-overlay" id="loading">
			<div class="spinner"></div>
		</div>
		<div class="toast-container" id="toast-container"></div>
	</div>
	<script src="main.js"></script>
</body>

</html>

